<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Optimal Control Utilities" href="OptimalControlUtilites.html" /><link rel="prev" title="Adaptive Mesh Refinement Tutorial" href="AutoMeshGuide.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.07.18 -->
        <title>Interface Enhancements - ASSET 0.5.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=613ab9ff" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: red;
  --color-brand-content: #CC3333;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">ASSET 0.5.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/ASSETLOGO.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">ASSET 0.5.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="tutorials.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Install.html">Installing ASSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="VectorFunctionGuide.html">Vector Function Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="ODEGuide.html">ODE Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntegratorGuide.html">Integrator Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="PhaseGuide.html">Optimal Control Phase Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimalControlProblem.html">Optimal Control Problem Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="PSIOPT.html">PSIOPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="AutoMeshGuide.html">Adaptive Mesh Refinement Tutorial</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Interface Enhancements</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimalControlUtilites.html">Optimal Control Utilities</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/Delta3.html">Delta 3 Multi-phase GTO Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ReentryExample.html">Space Shuttle Reentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/CartPole.html">Cart-Pole Swing Up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/HyperSensitive.html">Hyper-Sensitive Optimal Control Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/halo.html">Orbit Family Continuation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/zermelo.html">Zermelo’s Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/zermelolink.html">Multi-Phase Zermelo’s Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/MultiTarg.html">Multi-Spacecraft Optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/python.html">Python Library Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Python Library Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/asset.html">ASSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/optimalcontrol.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/vectorfunctions.html">Vector Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/Astro.html">ASSET Astro Library</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/NewInterface.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="interface-enhancements">
<h1>Interface Enhancements<a class="headerlink" href="#interface-enhancements" title="Link to this heading">¶</a></h1>
<p>Beginning in version 0.5.0, we have made significant improvements to the ODE, phase and OCP interfaces
in order to simplify the definition of more complex optimal control problems. Note that these changes are backwards
compatible and the previous tutorials and any existing code will continue to work as is. We will be updating all existing
tutorials to reflect the new changes at a later date, but for now we will provide a brief overview of the new features. A subset of
the existing examples have been updated to reflect the new interface and can be found in the examples/UpdatedInterface folder on the repo.</p>
<section id="ode-component-naming">
<h2>ODE Component Naming<a class="headerlink" href="#ode-component-naming" title="Link to this heading">¶</a></h2>
<p>The first major improvement is the ability to give string name aliases to the input arguments of an ODE in the constructor.
These names may then be used in place of integer indexes when applying constraints and objectives to phases
and optimal control problems. As an example, lets take a look at how this works for the ODE defined for the Delta-III
launch example.</p>
<p>Here, we define the ODE exactly as we normally would in terms of <code class="code docutils literal notranslate"><span class="pre">ODEArguments</span></code>. We can then add the different components of
the arguments to a dictionary indexed by the name or names that we want to use as aliases. Multiple aliases for the same variable
grouping can be used by indexing the dictionary with a tuple of string names. The variables of the alias can be specified with
the list integer indices,the actual segment or element, or a list of segments and/or elements. After populating the dictionary,we pass it
to the <code class="code docutils literal notranslate"><span class="pre">Vgroups</span></code> (Variable groups) argument of <code class="code docutils literal notranslate"><span class="pre">ODEBase</span></code>’s constructor.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RocketODE</span><span class="p">(</span><span class="n">oc</span><span class="o">.</span><span class="n">ODEBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">mdot</span><span class="p">):</span>
        <span class="c1">####################################################</span>
        <span class="n">XtU</span>  <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">ODEArguments</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">R</span> <span class="o">=</span> <span class="n">XtU</span><span class="o">.</span><span class="n">XVec</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">XtU</span><span class="o">.</span><span class="n">XVec</span><span class="p">()</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">XtU</span><span class="o">.</span><span class="n">XVar</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

        <span class="n">U</span> <span class="o">=</span> <span class="n">XtU</span><span class="o">.</span><span class="n">UVec</span><span class="p">()</span>

        <span class="n">h</span>       <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">-</span> <span class="n">Re</span>
        <span class="n">rho</span>     <span class="o">=</span> <span class="n">RhoAir</span> <span class="o">*</span> <span class="n">vf</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">h</span> <span class="o">/</span> <span class="n">h_scale</span><span class="p">)</span>
        <span class="n">Vr</span>      <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">We</span><span class="p">]))</span>

        <span class="n">D</span>       <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">CD</span><span class="o">*</span><span class="n">S</span><span class="p">)</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="n">Vr</span><span class="o">*</span><span class="n">Vr</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>

        <span class="n">Rdot</span>    <span class="o">=</span>  <span class="n">V</span>
        <span class="n">Vdot</span>    <span class="o">=</span>  <span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">R</span><span class="o">.</span><span class="n">normalized_power3</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span><span class="o">/</span><span class="n">m</span>

        <span class="n">ode</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">Rdot</span><span class="p">,</span><span class="n">Vdot</span><span class="p">,</span><span class="o">-</span><span class="n">mdot</span><span class="p">)</span>

        <span class="n">Vgroups</span> <span class="o">=</span> <span class="p">{}</span>


        <span class="n">Vgroups</span><span class="p">[(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="s2">&quot;Position&quot;</span><span class="p">)]</span><span class="o">=</span><span class="n">R</span>
        <span class="c1">#Vgroups[(&quot;R&quot;,&quot;Position&quot;)]=[0,1,2] # same as above</span>

        <span class="n">Vgroups</span><span class="p">[(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span><span class="s2">&quot;Velocity&quot;</span><span class="p">)]</span><span class="o">=</span><span class="n">V</span>
        <span class="n">Vgroups</span><span class="p">[(</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="s2">&quot;ThrustVec&quot;</span><span class="p">)]</span><span class="o">=</span><span class="n">U</span>

        <span class="n">Vgroups</span><span class="p">[</span><span class="s2">&quot;RV&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">R</span><span class="p">,</span><span class="n">V</span><span class="p">]</span>
        <span class="c1">#Vgroups[&quot;RV&quot;] = [0,1,2,3,4,5] # same as above</span>

        <span class="n">Vgroups</span><span class="p">[</span><span class="s2">&quot;Xt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">XtU</span><span class="o">.</span><span class="n">XtVec</span><span class="p">()</span>

        <span class="n">Vgroups</span><span class="p">[(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span><span class="s2">&quot;time&quot;</span><span class="p">)]</span><span class="o">=</span><span class="n">XtU</span><span class="o">.</span><span class="n">TVar</span><span class="p">()</span>
        <span class="n">Vgroups</span><span class="p">[(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span><span class="s2">&quot;mass&quot;</span><span class="p">)]</span><span class="o">=</span><span class="n">m</span>

        <span class="c1">####################################################</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">Vgroups</span> <span class="o">=</span> <span class="n">Vgroups</span><span class="p">)</span>
</pre></div>
</div>
<p>Having defined the variable groups for our ODE we can now use the string names or lists of string names
anywhere where we could previously use integer indices or lists of indices. As an example, lets take a look at how this would modify the
definition of the Delta-III launch vehicle optimal control problem below. For example, we can now simply use the alias <code class="code docutils literal notranslate"><span class="pre">&quot;U&quot;</span></code>, which we have
defined to be our thrust vector, when placing an LUNorm bound on our control. Similarly, we can replace the <code class="code docutils literal notranslate"><span class="pre">range(0,8)</span></code> in the boundary value specification,
with a list of string names specifying the different components of the states or with the combined alias <code class="code docutils literal notranslate"><span class="pre">&quot;Xt&quot;</span></code> of those same variables. Note that when specifying multiple names,
the combined index vector is just the concatenation of sub index vectors, so the order matters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#########################################</span>
<span class="n">phase1</span> <span class="o">=</span> <span class="n">ode1</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">tmode</span><span class="p">,</span><span class="n">IG1</span><span class="p">,</span><span class="n">nsegs1</span><span class="p">)</span>
<span class="n">phase1</span><span class="o">.</span><span class="n">setControlMode</span><span class="p">(</span><span class="n">cmode</span><span class="p">)</span>

<span class="n">phase1</span><span class="o">.</span><span class="n">addLUNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="c1">## Same as above</span>
<span class="c1">## phase1.addLUNormBound(&quot;Path&quot;,[8,9,10],.5,1.5)</span>

<span class="n">phase1</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Front&quot;</span><span class="p">,[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="s2">&quot;V&quot;</span><span class="p">,</span><span class="s2">&quot;m&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">],</span><span class="n">IG1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>
<span class="c1">## Same as above</span>
<span class="c1">##phase1.addBoundaryValue(&quot;Front&quot;,&quot;Xt&quot;,IG1[0][0:8])</span>
<span class="c1">##phase1.addBoundaryValue(&quot;Front&quot;,range(0,8),IG1[0][0:8])</span>


<span class="n">phase1</span><span class="o">.</span><span class="n">addLowerNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="n">Re</span><span class="o">*</span><span class="mf">.999999</span><span class="p">)</span>

<span class="n">phase1</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="n">tf_phase1</span><span class="p">)</span> <span class="c1">## Can drop brackets if scalar</span>
<span class="c1">## Same as above</span>
<span class="c1">## phase1.addBoundaryValue(&quot;Back&quot;,[7],[tf_phase1])</span>


<span class="c1">#########################################</span>
<span class="n">phase2</span> <span class="o">=</span> <span class="n">ode2</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">tmode</span><span class="p">,</span><span class="n">IG2</span><span class="p">,</span><span class="n">nsegs2</span><span class="p">)</span>
<span class="n">phase2</span><span class="o">.</span><span class="n">setControlMode</span><span class="p">(</span><span class="n">cmode</span><span class="p">)</span>

<span class="n">phase2</span><span class="o">.</span><span class="n">addLowerNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="n">Re</span><span class="p">)</span>
<span class="n">phase2</span><span class="o">.</span><span class="n">addLUNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">phase2</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Front&quot;</span><span class="p">,</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="n">m0_phase2</span><span class="p">)</span>
<span class="n">phase2</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span> <span class="p">,</span><span class="n">tf_phase2</span><span class="p">)</span>

<span class="c1">#########################################</span>
<span class="n">phase3</span> <span class="o">=</span> <span class="n">ode3</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">tmode</span><span class="p">,</span><span class="n">IG3</span><span class="p">,</span><span class="n">nsegs3</span><span class="p">)</span>
<span class="n">phase3</span><span class="o">.</span><span class="n">setControlMode</span><span class="p">(</span><span class="n">cmode</span><span class="p">)</span>

<span class="n">phase3</span><span class="o">.</span><span class="n">addLowerNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="n">Re</span><span class="p">)</span>
<span class="n">phase3</span><span class="o">.</span><span class="n">addLUNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">phase3</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Front&quot;</span><span class="p">,</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="n">m0_phase3</span><span class="p">)</span>
<span class="n">phase3</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span> <span class="p">,</span><span class="n">tf_phase3</span><span class="p">)</span>

<span class="c1">#########################################</span>
<span class="n">phase4</span> <span class="o">=</span> <span class="n">ode4</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">tmode</span><span class="p">,</span><span class="n">IG4</span><span class="p">,</span><span class="n">nsegs4</span><span class="p">)</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">setControlMode</span><span class="p">(</span><span class="n">cmode</span><span class="p">)</span>

<span class="n">phase4</span><span class="o">.</span><span class="n">addLowerNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="n">Re</span><span class="p">)</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addLUNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Front&quot;</span><span class="p">,</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="n">m0_phase4</span><span class="p">)</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addUpperVarBound</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="n">tf_phase4</span><span class="p">)</span>

<span class="n">phase4</span><span class="o">.</span><span class="n">addEqualCon</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span><span class="n">TargetOrbit</span><span class="p">(</span><span class="n">at</span><span class="p">,</span><span class="n">et</span><span class="p">,</span><span class="n">istart</span><span class="p">,</span><span class="n">Ot</span><span class="p">,</span><span class="n">Wt</span><span class="p">),[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="s2">&quot;V&quot;</span><span class="p">])</span>
<span class="c1">## Same as above</span>
<span class="c1">## phase4.addEqualCon(&quot;Back&quot;,TargetOrbit(at,et,istart,Ot,Wt),&quot;RV&quot;)</span>

<span class="c1"># Maximize final mass</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addValueObjective</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1">#########################################</span>
</pre></div>
</div>
<p>We can also now use these same string names when applying any link constraints and objectives to <code class="code docutils literal notranslate"><span class="pre">OptimalControlProblem</span></code> objects.
So for the Delta-III example, we can modify the <code class="code docutils literal notranslate"><span class="pre">addForwardLinkEqualCon</span></code> as shown below. Note that you will need to define the string aliases in the ODE
associated with each phase. Note however that the indices specified by a string name do not have to be the same in every phase/ODE linked
(though they are in this case). This makes it much easier to enforce continuity between variables in each phase even if they
have different indices. For example, in the old interface, models with different numbers of state variables would have different indices for time.
Now, so long as the user names time say <code class="code docutils literal notranslate"><span class="pre">&quot;t&quot;</span></code> in both model definitions, then the call below will enforce continuity correctly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ocp</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">OptimalControlProblem</span><span class="p">()</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addPhase</span><span class="p">(</span><span class="n">phase1</span><span class="p">)</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addPhase</span><span class="p">(</span><span class="n">phase2</span><span class="p">)</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addPhase</span><span class="p">(</span><span class="n">phase3</span><span class="p">)</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addPhase</span><span class="p">(</span><span class="n">phase4</span><span class="p">)</span>



<span class="c1">## All phases continuous in everything but mass (var 6)</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addForwardLinkEqualCon</span><span class="p">(</span><span class="n">phase1</span><span class="p">,</span><span class="n">phase4</span><span class="p">,[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="s2">&quot;V&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">,</span><span class="s2">&quot;U&quot;</span><span class="p">])</span>

<span class="c1">## Same as above</span>
<span class="c1">##ocp.addForwardLinkEqualCon(phase1,phase4,[0,1,2,3,4,5, 7,8,9,10])</span>
</pre></div>
</div>
<p>Finally, the new string names or lists of names can also be used when applying specifying the inputs to control law for an ODE’s integrator as shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ode</span> <span class="o">=</span> <span class="n">RocketODE</span><span class="p">(</span><span class="n">T_phase1</span><span class="p">,</span><span class="n">mdot_phase1</span><span class="p">)</span>

<span class="n">integ</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">integrator</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">Args</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">(),</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="auto-scaling">
<h2>Auto-Scaling<a class="headerlink" href="#auto-scaling" title="Link to this heading">¶</a></h2>
<p>The second major addition to the interface is automatic problem scaling from user defined canonical units. In the
Delta-III and Shuttle tutorials we emphasized the importance of defining problems in non-dimensional units. This is typically
done by defining a set of base length, mass, and time units and then redefining all constants and boundary conditions in this new
unit system. This is easy enough for simple problems like the Delta-III, but quickly becomes cumbersome for more complex scenarios.
For that we reason, we have added interfaces to <code class="code docutils literal notranslate"><span class="pre">phase</span></code> and <code class="code docutils literal notranslate"><span class="pre">OptimalControlProblem</span></code> that will handle this non-dimensionalization behind the scenes
and allow users to specify their problem in traditional units. To use this interface, the user must enable auto scaling and declare the canonical units
associated with each ODE input variable for a phase. As shown below for the Delta-III example, we can specify the units using code:<cite>phase.setUnits</cite>
by passing a single vector with the same dimensions as the ODE’s input vector, or if we defined names for our components, we can assign them by name.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phase1</span> <span class="o">=</span> <span class="n">ode1</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">tmode</span><span class="p">,</span><span class="n">IG1</span><span class="p">,</span><span class="n">nsegs1</span><span class="p">)</span>
<span class="n">phase1</span><span class="o">.</span><span class="n">setControlMode</span><span class="p">(</span><span class="n">cmode</span><span class="p">)</span>

<span class="c1">## Enable AutoScaling, off by default</span>
<span class="n">phase1</span><span class="o">.</span><span class="n">setAutoScaling</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">units</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">11</span><span class="p">))</span>
<span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">Lstar</span>
<span class="n">units</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="n">Vstar</span>
<span class="n">units</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="n">Mstar</span>
<span class="n">units</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">=</span><span class="n">Tstar</span>
<span class="c1">## All others are one,i.e no auto-scaling</span>

<span class="n">phase1</span><span class="o">.</span><span class="n">setUnits</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>  <span class="c1"># As a single vector</span>
<span class="c1"># Or</span>
<span class="n">phase1</span><span class="o">.</span><span class="n">setUnits</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">Lstar</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">Vstar</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">Tstar</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="n">Mstar</span><span class="p">)</span>


<span class="n">phase1</span><span class="o">.</span><span class="n">addLUNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">phase1</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Front&quot;</span><span class="p">,[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="s2">&quot;V&quot;</span><span class="p">,</span><span class="s2">&quot;m&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">],</span><span class="n">IG1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>

<span class="c1">#. Continue definition</span>
<span class="c1">#.</span>
<span class="c1">#</span>
</pre></div>
</div>
<p>The specified canonical units will be used under the hood to non-dimensionalize any trajectory passed into the phase and any variables sent to the optimizer.
From the units for the states and times, we can also uniquely determine a set of output scales for the transcription defect constraints that will make them equivalent
to a problem that was non-dimensionalized by hand.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When auto-scaling is enabled the mesh tolerance for adaptive mesh refinement refers to the scaled ODE system.</p>
</div>
<p>However, since we don’t track the physical units of functions, this is not possible for all other constraints and objectives added to phase.
By default for all non-dynamics constraints and objectives, we compute a set of output scales that normalizes each row of
the function’s Jacobian at the initial guess for the problem. Alternatively, the user can override these scales manually.
All of this is controlled via an optional <code class="code docutils literal notranslate"><span class="pre">AutoScale`</span></code> argument that has been,
added to all <code class="code docutils literal notranslate"><span class="pre">phase`</span></code> and <code class="code docutils literal notranslate"><span class="pre">OptimalControlProblem</span></code> <code class="code docutils literal notranslate"><span class="pre">.add###`</span></code> methods. As an example, lets take a look at a portion of the definition of the Delta-III problem again below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## AutoScale = &quot;auto&quot; if not specified</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Front&quot;</span><span class="p">,</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span> <span class="n">m0_phase4</span><span class="p">)</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addUpperVarBound</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="n">tf_phase4</span><span class="p">)</span>
<span class="c1"># AutoScale=None, will turn it off for this constraint</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addLUNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;U&quot;</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="n">AutoScale</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Override the scale for this constraint</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addLowerNormBound</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="n">Re</span><span class="p">,</span><span class="n">AutoScale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Lstar</span><span class="p">)</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addEqualCon</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span><span class="n">TargetOrbit</span><span class="p">(</span><span class="n">at</span><span class="p">,</span><span class="n">et</span><span class="p">,</span><span class="n">istart</span><span class="p">,</span><span class="n">Ot</span><span class="p">,</span><span class="n">Wt</span><span class="p">),[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="s2">&quot;V&quot;</span><span class="p">],</span><span class="n">AutoScale</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">Lstar</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>

<span class="c1"># Maximize final mass</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">addValueObjective</span><span class="p">(</span><span class="s2">&quot;Back&quot;</span><span class="p">,</span><span class="s2">&quot;mass&quot;</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>By default <code class="code docutils literal notranslate"><span class="pre">AutoScale</span></code> is set to <code class="code docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> for all constraints and objectives. This will work well in most cases, but can be overridden when the user can specify a better scale factor.
Manual scales specified by a assigning a scalar or vector of scales to the <code class="code docutils literal notranslate"><span class="pre">AutoScale</span></code> parameter. These will multiply the output of the function whenever AutoScaling is enabled.
For example, for the bound on <code class="code docutils literal notranslate"><span class="pre">&quot;R&quot;</span></code>, we know that the units of the output will have dimensions of length, so it is reasonable to set the AutoScale variable to <code class="code docutils literal notranslate"><span class="pre">1/Lstar</span></code>.
Similarly, for the <code class="code docutils literal notranslate"><span class="pre">TargetOrbit</span></code> constraint, we know that the first component of the output(semi-major axis) has dimensions of length and all others are already non-dimensional.
In that case, we can manually specify the output scale of the first component and then leave the others set to 1.0.</p>
<p>When adding multiple phases to an <code class="code docutils literal notranslate"><span class="pre">OptimalControlProblem</span></code> we should also enable AutoScaling for the <code class="code docutils literal notranslate"><span class="pre">ocp</span></code> object as well. This will enable AutoScaling
on all link constraints and objectives between phases. It should also be noted that units do not have to be the same for all phases in an <code class="code docutils literal notranslate"><span class="pre">ocp</span></code>.
As with phases, the optional <code class="code docutils literal notranslate"><span class="pre">AutoScale</span></code> parameter on all link constraints and objectives can be overridden
with custom scales if necessary.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ocp</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">OptimalControlProblem</span><span class="p">()</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addPhase</span><span class="p">(</span><span class="n">phase1</span><span class="p">)</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addPhase</span><span class="p">(</span><span class="n">phase2</span><span class="p">)</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addPhase</span><span class="p">(</span><span class="n">phase3</span><span class="p">)</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addPhase</span><span class="p">(</span><span class="n">phase4</span><span class="p">)</span>

<span class="c1"># Enable AutoScaling for the OCP,and all constitiuent phases currently in ocp</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">setAutoScaling</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">setAdaptiveMesh</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


<span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="n">ocp</span><span class="o">.</span><span class="n">Phases</span><span class="p">:</span>
    <span class="n">phase</span><span class="o">.</span><span class="n">setUnits</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">Lstar</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">Vstar</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">Tstar</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="n">Mstar</span><span class="p">)</span>
    <span class="n">phase</span><span class="o">.</span><span class="n">setMeshTol</span><span class="p">(</span><span class="mf">1.0e-6</span><span class="p">)</span>
    <span class="n">phase</span><span class="o">.</span><span class="n">setMeshErrorCriteria</span><span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
    <span class="n">phase</span><span class="o">.</span><span class="n">setMeshErrorEstimator</span><span class="p">(</span><span class="s1">&#39;integrator&#39;</span><span class="p">)</span>


<span class="c1">## Each Phase does not have to have the same AutoScale units even if its the same ODE</span>
<span class="n">phase4</span><span class="o">.</span><span class="n">setUnits</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">Lstar</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">Vstar</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mf">.8</span><span class="o">*</span><span class="n">Tstar</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="n">Mstar</span><span class="p">)</span>

<span class="c1">## Can override the AutoScale for any link constraints and objectives as well</span>
<span class="n">ocp</span><span class="o">.</span><span class="n">addForwardLinkEqualCon</span><span class="p">(</span><span class="n">phase1</span><span class="p">,</span><span class="n">phase4</span><span class="p">,[</span><span class="s2">&quot;R&quot;</span><span class="p">,</span><span class="s2">&quot;V&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">,</span><span class="s2">&quot;U&quot;</span><span class="p">],</span><span class="n">AutoScale</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="OptimalControlUtilites.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Optimal Control Utilities</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="AutoMeshGuide.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Adaptive Mesh Refinement Tutorial</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2023, UA ASRL
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Interface Enhancements</a><ul>
<li><a class="reference internal" href="#ode-component-naming">ODE Component Naming</a></li>
<li><a class="reference internal" href="#auto-scaling">Auto-Scaling</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=b9afe91b"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>