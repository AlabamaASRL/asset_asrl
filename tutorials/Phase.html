<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Python: Vector Functions" href="VectorFunctions_tutorial.html" /><link rel="prev" title="PSIOPT" href="PSIOPT.html" />

    <meta name="generator" content="sphinx-4.2.0, furo 2022.09.29"/>
        <title>Phase Tutorial - ASSET 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: red;
  --color-brand-content: #CC3333;
  --color-admonition-background: orange;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">ASSET 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">ASSET 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="tutorials.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Installation.html">Python: Installing ASSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="VectorFunctionGuide.html">Vector Function Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="ODEGuide.html">ODE Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntegratorGuide.html">Integrator Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="PhaseGuide.html">Optimal Control Phase Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimalControlProblem.html">Optimal Control Problem Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="PSIOPT.html">PSIOPT</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Phase Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="VectorFunctions_tutorial.html">Python: Vector Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Integrator.html">Integrators</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/halo.html">Example 1: Orbit Family Continuation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/zermelo.html">Example 2a: Zermelo’s Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/zermelolink.html">Example 2b: Multi-Phase Zermelo’s Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/MultiTarg.html">Example 3: Multi-Spacecraft Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/Delta3.html">Delta 3 Multi-phase GTO Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/ReentryExample.html">Space Shuttle Reentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/CartPole.html">Cart Pole Swing Up</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/python.html">Python Library Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/asset.html">ASSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/optimalcontrol.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/vectorfunctions.html">Vector Functions</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="phase-tutorial">
<h1>Phase Tutorial<a class="headerlink" href="#phase-tutorial" title="Permalink to this headline">#</a></h1>
<p>Having now gone over how to construct both vector functions and odes, we will now take a look at how we leverage them to solve optimal control problems.
Continuing with the previous example <a class="reference internal" href="VectorFunctions_tutorial.html#python-vector-functions"><span class="std std-ref">Python: Vector Functions</span></a>, we will find a minimum time solar sail transfer between two circular orbits.
For this problem we non-dimensionalize <span class="math notranslate nohighlight">\(\mu\)</span> to one and use a sail <span class="math notranslate nohighlight">\(\beta\)</span> value of 0.02.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">ode</span> <span class="o">=</span> <span class="n">Full_TwoBody_SolarSail_Model</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
</pre></div>
</div>
<p>We will begin our sail with initial state in a circular orbit with radius and velocity equal to one on the x axis.
From here, we will need to generate an initial guess for the transfer to a circular orbit of radius 1.1.
We can generate this initial guess by passing a simple control law to the constructor of the ode integrator as shown below.
The control law ProgradeFunc, takes 6 arguments defined to be the local position and velocity and returns the normalized sum of their unit vectors, which will be used as the sail normal direction.
Orienting the sail in this manner will increase orbit radius.
Note that <code class="code python docutils literal notranslate"><span class="name builtin"><span class="pre">range</span></span><span class="punctuation"><span class="pre">(</span></span><span class="literal number integer"><span class="pre">0</span></span><span class="punctuation"><span class="pre">,</span></span><span class="literal number integer"><span class="pre">6</span></span><span class="punctuation"><span class="pre">)</span></span></code> in the contructor denotes that the integrator should forward state variables 0 through 6 (position and velocity) to the control function.
Once initialized, we call <code class="code docutils literal notranslate"><span class="pre">integrate_dense</span></code> with our initial state, a guess for the final TOF, and specify the number of states we want in the returned trajectory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">R0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">V0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">RF</span> <span class="o">=</span> <span class="mf">1.1</span>

<span class="n">IState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">))</span>
<span class="n">IState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">R0</span>
<span class="n">IState</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">V0</span>
<span class="n">IState</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">ProgradeFunc</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">rhat</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">head3</span><span class="p">()</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
    <span class="n">vhat</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">tail3</span><span class="p">()</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rhat</span> <span class="o">+</span> <span class="n">vhat</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>


<span class="n">integ</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">integrator</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">ProgradeFunc</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">IG</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">integrate_dense</span><span class="p">(</span><span class="n">IState</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<p>Given this initial guess we can now construct a phase object and begin defining the optimization problem.
To construct a phase from an existing ode, we pass a transcription method the phase member along with the initial guess and the number of segments we want to use to approximate the trajectory.
For this example we will use 300 LGL3 (Hermite Simpson) segments.
Users can currently choose LGL methods of orders 3, 5, and 7.
The Higher order methods generally require fewer segements, to achieve a desired accuracy, but for most applications LGL3 is sufficient.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">Tmodes</span><span class="o">.</span><span class="n">LGL3</span><span class="p">,</span> <span class="n">IG</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we will add a constraint to the phase specifying that initial state in the trajectory should be fixed to an initial circular orbit.
This can be accomplished by adding a boundary value constraint to the phase as shown below.
The first argument to <code class="code docutils literal notranslate"><span class="pre">addBoundaryValue()</span></code> specifies the Phase Region where it is to be applied.
In this case we want to apply it to the first state which is specified by <code class="code docutils literal notranslate"><span class="pre">PhaseRegs.Front</span></code>.
The next argument is then a list of state variable indices that we are going to fix, followed by a vector containing the perscribed boundary value.
In our case we are assigning state the postion, velocity and time variables to match the initial state.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="n">PhaseRegs</span><span class="o">.</span><span class="n">Front</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">IState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<p>Next we want to add two constraints to bound our controls throughout the transfer.
The first of these simply bounds the norm of out sail-normal vector the be of order 1.
Recall from our the definition of the sail ode, that the sail normal vector <span class="math notranslate nohighlight">\(\hat{n}\)</span> is normalized inside of the model, so will always be unit length when computing the thrust.
However, because <span class="math notranslate nohighlight">\(\hat{n}\)</span> itself is not explicityly constrained to have a certain norm, the optimizer could attempt to make <code class="code docutils literal notranslate"><span class="pre">n</span></code> equal to 0, which would make the the derivatives of what’s inside of our model undefined.
To prevent this we add an <code class="code docutils literal notranslate"><span class="pre">LUNormBound()</span></code> to the phase.
Similar to the boundary value, the first argument to <code class="code docutils literal notranslate"><span class="pre">addLUNormBound()</span></code> is the phase region where we want to apply the constraint.
In this case we want to apply the bound at <code class="code docutils literal notranslate"><span class="pre">PhaseReg.Path</span></code> which specifies every state in the trajectory.
The next argument are indices of the state variables of the vector to be bounded.
In our case, we want to specify the the indices of <code class="code docutils literal notranslate"><span class="pre">n</span></code> as 7, 8, and 9.
The final arguments are then the lower and upper bounds on the norm, respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span><span class="o">.</span><span class="n">addLUNormBound</span><span class="p">(</span><span class="n">PhaseRegs</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally, we would need to add a constraint that will bound our sail incidence angle to be less than 90 degrees.
Anything greater would be unphysical.
To do this we first write a vector function that takes the position and normal vector of the sail and returns the cosine of the angle between them.
We then add a constraint to bound the output of this function to be greater than <span class="math notranslate nohighlight">\(cos(90)\)</span> (which = 0) througout the transfer.
Similar to before, we first pass the <code class="code docutils literal notranslate"><span class="pre">PhaseReg.Path</span></code>.
This is then followed by the function and variable indices needed to invoke it.
The next argument is then the lower bound followed by a scale factor for the constraint which we will set to 1.0.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CosAlpha</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">rhat</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">head3</span><span class="p">()</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
    <span class="n">nhat</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">tail3</span><span class="p">()</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">vf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rhat</span><span class="p">,</span> <span class="n">nhat</span><span class="p">)</span>


<span class="n">MaxAlpha</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="n">CosMaxAlpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">MaxAlpha</span><span class="p">))</span>


<span class="n">phase</span><span class="o">.</span><span class="n">addLowerFuncBound</span><span class="p">(</span>
    <span class="n">PhaseRegs</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">CosAlpha</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">CosMaxAlpha</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now for the terminal constraint we will write a function taking postion and velocity, enforcing that the terminal state is in a planar circular orbit of radius <code class="code docutils literal notranslate"><span class="pre">RF</span></code>.
This function is applied at <code class="code docutils literal notranslate"><span class="pre">PhaseRegs.Back</span></code> (the last state in the trajectory), and by definition needs the position and velocity variables (<code class="code docutils literal notranslate"><span class="pre">range(0,6)</span></code>) in order to be invoked.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span><span class="o">.</span><span class="n">addEqualCon</span><span class="p">(</span><span class="n">PhaseRegs</span><span class="o">.</span><span class="n">Back</span><span class="p">,</span> <span class="n">VCirc</span><span class="p">(</span><span class="n">RF</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
<p>Finally, we add our objective function to the phase and optimize the transfer.
In this case, we would like to minimize the time of flight which can be specified with <code class="code docutils literal notranslate"><span class="pre">addDeltaTimeObjective()</span></code>, with the argument being a scale factor that we will set to one.
For this example it is also good idea to enable the optimizer’s line search and specify a consertive number of line search iterations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span><span class="o">.</span><span class="n">addDeltaTimeObjective</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">phase</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">OptLSMode</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">LineSearchModes</span><span class="o">.</span><span class="n">L1</span>
<span class="n">phase</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">MaxLSIters</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">phase</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>

<span class="n">TrajConv</span> <span class="o">=</span> <span class="n">phase</span><span class="o">.</span><span class="n">returnTraj</span><span class="p">()</span>
</pre></div>
</div>
<p>The optimal transfer has a total TOF of 6.75 and is plotted below along with the initial guess.</p>
<a class="reference internal image-reference" href="../_images/PhaseTransfer.png"><img alt="../_images/PhaseTransfer.png" src="../_images/PhaseTransfer.png" style="width: 100%;" /></a>
<section id="full-source-listing">
<h2>Full Source Listing<a class="headerlink" href="#full-source-listing" title="Permalink to this headline">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">asset</span> <span class="k">as</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">vf</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">VectorFunctions</span>
<span class="n">oc</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">OptimalControl</span>

<span class="n">Args</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">Arguments</span>
<span class="n">Tmodes</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">TranscriptionModes</span>
<span class="n">Cmodes</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">ControlModes</span>
<span class="n">PhaseRegs</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">PhaseRegionFlags</span>


<span class="k">def</span> <span class="nf">SolarSail_Acc</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
    <span class="n">ndr2</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">squared</span><span class="p">()</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">ndr2</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">inverse_four_norm</span><span class="p">()</span> <span class="o">*</span> <span class="n">n</span><span class="o">.</span><span class="n">normalized_power3</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">acc</span>


<span class="k">class</span> <span class="nc">Full_TwoBody_SolarSail_Model</span><span class="p">(</span><span class="n">oc</span><span class="o">.</span><span class="n">ode_x_u</span><span class="o">.</span><span class="n">ode</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
        <span class="n">Xvars</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="n">Uvars</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">Ivars</span> <span class="o">=</span> <span class="n">Xvars</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">Uvars</span>
        <span class="c1">#############################</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">(</span><span class="n">Ivars</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">head_3</span><span class="p">()</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">segment_3</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">tail_3</span><span class="p">()</span>
        <span class="n">acc</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">normalized_power3</span><span class="p">()</span> <span class="o">+</span> <span class="n">SolarSail_Acc</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">mu</span><span class="p">)</span>
        <span class="n">odeeq</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">Stack</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="n">acc</span><span class="p">])</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">odeeq</span><span class="p">,</span> <span class="n">Xvars</span><span class="p">,</span> <span class="n">Uvars</span><span class="p">)</span>


<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.02</span>

<span class="n">ode</span> <span class="o">=</span> <span class="n">Full_TwoBody_SolarSail_Model</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>


<span class="n">R0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">V0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">RF</span> <span class="o">=</span> <span class="mf">1.1</span>

<span class="n">IState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">))</span>
<span class="n">IState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">R0</span>
<span class="n">IState</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">V0</span>
<span class="n">IState</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">ProgradeFunc</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">rhat</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">head3</span><span class="p">()</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
    <span class="n">vhat</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">tail3</span><span class="p">()</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rhat</span> <span class="o">+</span> <span class="n">vhat</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>


<span class="n">integ</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">integrator</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">ProgradeFunc</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">IG</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">integrate_dense</span><span class="p">(</span><span class="n">IState</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">IGT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">IG</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>


<span class="n">phase</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">Tmodes</span><span class="o">.</span><span class="n">LGL3</span><span class="p">,</span> <span class="n">IG</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="n">phase</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="n">PhaseRegs</span><span class="o">.</span><span class="n">Front</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">IState</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>

<span class="n">phase</span><span class="o">.</span><span class="n">addLUNormBound</span><span class="p">(</span><span class="n">PhaseRegs</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CosAlpha</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">rhat</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">head3</span><span class="p">()</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
    <span class="n">nhat</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">tail3</span><span class="p">()</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">vf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rhat</span><span class="p">,</span> <span class="n">nhat</span><span class="p">)</span>


<span class="n">MaxAlpha</span> <span class="o">=</span> <span class="mf">60.0</span>
<span class="n">CosMaxAlpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">MaxAlpha</span><span class="p">))</span>


<span class="n">phase</span><span class="o">.</span><span class="n">addLowerFuncBound</span><span class="p">(</span>
    <span class="n">PhaseRegs</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">CosAlpha</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">CosMaxAlpha</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">VCirc</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">rvec</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">head3</span><span class="p">()</span>
    <span class="n">vvec</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">tail3</span><span class="p">()</span>

    <span class="n">f1</span> <span class="o">=</span> <span class="n">rvec</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="n">r</span><span class="p">]</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">vvec</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="n">r</span><span class="p">)]</span>
    <span class="n">f3</span> <span class="o">=</span> <span class="n">vf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rvec</span><span class="o">.</span><span class="n">normalized</span><span class="p">(),</span> <span class="n">vvec</span><span class="o">.</span><span class="n">normalized</span><span class="p">())</span>
    <span class="n">f4</span> <span class="o">=</span> <span class="n">rvec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">f5</span> <span class="o">=</span> <span class="n">vvec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">vf</span><span class="o">.</span><span class="n">Stack</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">,</span> <span class="n">f5</span><span class="p">])</span>


<span class="n">phase</span><span class="o">.</span><span class="n">addEqualCon</span><span class="p">(</span><span class="n">PhaseRegs</span><span class="o">.</span><span class="n">Back</span><span class="p">,</span> <span class="n">VCirc</span><span class="p">(</span><span class="n">RF</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">phase</span><span class="o">.</span><span class="n">addDeltaTimeObjective</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">phase</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">OptLSMode</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">LineSearchModes</span><span class="o">.</span><span class="n">L1</span>
<span class="n">phase</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">MaxLSIters</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">phase</span><span class="o">.</span><span class="n">Threads</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">phase</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>


<span class="c1">############################################################################</span>
<span class="n">TrajConv</span> <span class="o">=</span> <span class="n">phase</span><span class="o">.</span><span class="n">returnTraj</span><span class="p">()</span>
<span class="n">TT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">TrajConv</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TT</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TT</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimal Trajectory&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IGT</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">IGT</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Initial Guess&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">TT</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">TT</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">IGT</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">IGT</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">IGT</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">IGT</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>

<span class="n">angs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">XX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angs</span><span class="p">)</span>
<span class="n">YY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angs</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XX</span> <span class="o">*</span> <span class="n">R0</span><span class="p">,</span> <span class="n">YY</span> <span class="o">*</span> <span class="n">R0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XX</span> <span class="o">*</span> <span class="n">RF</span><span class="p">,</span> <span class="n">YY</span> <span class="o">*</span> <span class="n">RF</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;Equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">TrajConv</span><span class="p">:</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">CosAlpha</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">))))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TT</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">alphas</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">############################################################################</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="VectorFunctions_tutorial.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Python: Vector Functions</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="PSIOPT.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">PSIOPT</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, UA ASRL
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Phase Tutorial</a><ul>
<li><a class="reference internal" href="#full-source-listing">Full Source Listing</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>