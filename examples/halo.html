<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Zermelo’s Problem" href="zermelo.html" /><link rel="prev" title="Hyper-Sensitive Optimal Control Problem" href="HyperSensitive.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.05.20 -->
        <title>Orbit Family Continuation - ASSET 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: red;
  --color-brand-content: #CC3333;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">ASSET 0.2.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/ASSETLOGO.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">ASSET 0.2.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorials.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/Install.html">Installing ASSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/VectorFunctionGuide.html">Vector Function Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/ODEGuide.html">ODE Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/IntegratorGuide.html">Integrator Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/PhaseGuide.html">Optimal Control Phase Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/OptimalControlProblem.html">Optimal Control Problem Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/PSIOPT.html">PSIOPT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/AutoMeshGuide.html">Adaptive Mesh Refinement Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/OptimalControlUtilites.html">Optimal Control Utilities</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="examples.html">Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Delta3.html">Delta 3 Multi-phase GTO Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReentryExample.html">Space Shuttle Reentry</a></li>
<li class="toctree-l2"><a class="reference internal" href="CartPole.html">Cart-Pole Swing Up</a></li>
<li class="toctree-l2"><a class="reference internal" href="HyperSensitive.html">Hyper-Sensitive Optimal Control Problem</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Orbit Family Continuation</a></li>
<li class="toctree-l2"><a class="reference internal" href="zermelo.html">Zermelo’s Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="zermelolink.html">Multi-Phase Zermelo’s Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiTarg.html">Multi-Spacecraft Optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/python.html">Python Library Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Python Library Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/asset.html">ASSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/optimalcontrol.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/vectorfunctions.html">Vector Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/Astro.html">ASSET Astro Library</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="orbit-family-continuation">
<h1>Orbit Family Continuation<a class="headerlink" href="#orbit-family-continuation" title="Permalink to this heading">#</a></h1>
<p>A use case familiar to all astrodynamicists is the generation of orbit families via continuation from an initial orbit.
ASSET makes reconvergence of slightly perturbed solutions quick and simple by using common python idioms.
The scenario we will investigate is in the Earth-Moon CR3BP, where we want to build the L1 Planar and Northern Halo families from two approximate initial conditions.</p>
<section id="problem-setup">
<h2>Problem Setup<a class="headerlink" href="#problem-setup" title="Permalink to this heading">#</a></h2>
<p>All python scripts begin by importing necessary external packages.
Obviously, we will need ASSET, but we will also use numpy for arrays and matplotlib for graphing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">asset_asrl</span> <span class="k">as</span> <span class="nn">ast</span>
<span class="kn">from</span> <span class="nn">asset_asrl.Astro.AstroModels</span> <span class="kn">import</span> <span class="n">CR3BP</span>
<span class="kn">import</span> <span class="nn">asset_asrl.Astro.Constants</span> <span class="k">as</span> <span class="nn">c</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>Next, we will define shorthand abbreviations for some of ASSET’s common functionality.
<code class="code docutils literal notranslate"><span class="pre">OptimalControl</span></code> and <code class="code docutils literal notranslate"><span class="pre">VectorFunctions</span></code> are the two primary submodules, and it makes it easier on us if we don’t have to type the full name every time.
<code class="code docutils literal notranslate"><span class="pre">PhaseRegionFlags</span></code> and <code class="code docutils literal notranslate"><span class="pre">TranscriptionModes</span></code> are enumerators used to specify behavior when we’re constructing the solver.
If they are unfamiliar, you should go back to the introductory tutorials.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># Setup</span>
<span class="n">oc</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">OptimalControl</span>
<span class="n">vf</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">VectorFunctions</span>

<span class="n">phaseRegs</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">PhaseRegionFlags</span>
<span class="n">tModes</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">TranscriptionModes</span>
</pre></div>
</div>
<p>Now we define some system parameters.
These quantities are known ahead of time and will not change during the course of continuation or optimization.
For our test problem, we are analyzing the Earth-Moon system, so the appropriate masses and characteristic distance go here.
Also, we define a delta-t for our integrator step.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># Constants</span>
<span class="n">muE</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">MuEarth</span>  <span class="c1"># Earth gravitational parameter</span>
<span class="n">muM</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">MuMoon</span> <span class="c1"># Moon gravitational parameter</span>
<span class="n">lstar</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">LD</span> <span class="c1">#Earth-Moon characteristic distance (m)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">3.1415</span> <span class="o">/</span> <span class="mi">10000</span>
</pre></div>
</div>
<p>Given the known system parameters, we can construct the dynamical model.
ASSET is written generically from a low level, but we tailor it to astrodynamics by providing some pre-built models, such as the CR3BP.
The instance of the governing ordinary differential equations (ODE) for the CR3BP model is instantiated with the gravitational parameters of the
Earth and Moon (in <span class="math notranslate nohighlight">\(\frac{m^3}{s^2}\)</span>), along with a characteristic distance (in this case its the average distance between the Earth and Moon in meters).
The non-dimensional gravity parameter, <span class="math notranslate nohighlight">\(\mu\)</span>, of the system is stored within the CR3BP model as a member.
Furthermore, the ODE has an integrator associated with it which we can instantiate with a fixed time step dt.
The <code class="code docutils literal notranslate"><span class="pre">dt</span></code> here is the maximum allowable time step whenever the integrator is invoked.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># System Dynamics</span>

<span class="n">ode</span> <span class="o">=</span> <span class="n">CR3BP</span><span class="p">(</span><span class="n">muE</span><span class="p">,</span> <span class="n">muM</span><span class="p">,</span> <span class="n">lstar</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">mu</span>

<span class="c1"># Create integrator (= propagator)</span>
<span class="n">odeItg</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">integrator</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="constructing-a-generic-periodic-solver">
<h2>Constructing a Generic Periodic Solver<a class="headerlink" href="#constructing-a-generic-periodic-solver" title="Permalink to this heading">#</a></h2>
<p>Astrodynamicists are certainly aware that the characteristic that defines periodicity in the CR3BP is an orthogonal crossing of the x-z plane.
In order to have good code re-usability, let’s define a function that will try to solve a periodic orbit given some inital guess of state and duration.
Here’s the function signature we will use: <code class="code docutils literal notranslate"><span class="pre">def</span> <span class="pre">solvePeriodic(ig,</span> <span class="pre">tf,</span> <span class="pre">fixInit=[0,</span> <span class="pre">1,</span> <span class="pre">2]):</span></code>
The first parameter, <code class="code docutils literal notranslate"><span class="pre">ig</span></code>, is a 7-element vector with <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span> position in the first elements, <span class="math notranslate nohighlight">\(v_x\)</span>, <span class="math notranslate nohighlight">\(v_y\)</span>, <span class="math notranslate nohighlight">\(v_z\)</span> in the next 3 elements, and initial time <span class="math notranslate nohighlight">\(t_0\)</span> in the last position.
The second parameter, <code class="code docutils literal notranslate"><span class="pre">tf</span></code>, will be the best guess for the orbit’s half-period.
The third parameter, <code class="code docutils literal notranslate"><span class="pre">fixInit</span></code>, defines which terms of the initial guess are not to be changed during the solve.
For example, if you want a planar orbit, you would set <code class="code docutils literal notranslate"><span class="pre">ig[2]</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="code docutils literal notranslate"><span class="pre">fixInit</span> <span class="pre">=</span> <span class="pre">[2]</span></code> to fix the second element of the guess.
Or, suppose you just want to find some orbit with a certain <span class="math notranslate nohighlight">\(v_y\)</span>.
You could pass <code class="code docutils literal notranslate"><span class="pre">fixInit</span> <span class="pre">=</span> <span class="pre">[4]</span></code> to lock the initial velocity but allow the starting position to change.</p>
<p>Given these arguments, the outline for solution is as follows:</p>
<ol class="arabic simple">
<li><p>Integrate the initial guess state to get an initial trajectory guess.</p></li>
<li><p>Create an optimal control phase and initailize it with the trajectory guess.</p></li>
<li><p>Add constraints to the phase that are appropriate for periodicity.</p></li>
<li><p>Solve for the orbit.</p></li>
<li><p>Return the orbit.</p></li>
</ol>
<p>Here is the python implementation, with discussion below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># Solve for periodic orbit using initial guess ig</span>
<span class="k">def</span> <span class="nf">solvePeriodic</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">odeItg</span><span class="p">,</span> <span class="n">fixInit</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="c1"># 1: Integrate initial guess</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">trajGuess</span> <span class="o">=</span> <span class="n">odeItg</span><span class="o">.</span><span class="n">integrate_dense</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>

    <span class="c1"># 2: Create optimal control phase and assign guess</span>
    <span class="n">odePhase</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">CR3BP</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">tModes</span><span class="o">.</span><span class="n">LGL3</span><span class="p">)</span>  <span class="c1"># LGL-3 collocation</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">Threads</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Equal to number of physical cores</span>

    <span class="n">nSeg</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># number of segments</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">setTraj</span><span class="p">(</span><span class="n">trajGuess</span><span class="p">,</span> <span class="n">nSeg</span><span class="p">)</span>

    <span class="c1"># 3: Set Boundary Constraints</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">fixInit</span><span class="p">:</span>
        <span class="n">odePhase</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="n">phaseRegs</span><span class="o">.</span><span class="n">Front</span><span class="p">,</span> <span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="p">[</span><span class="n">trajGuess</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">]])</span>

    <span class="n">odePhase</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span>
        <span class="n">phaseRegs</span><span class="o">.</span><span class="n">Front</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># Initial y, vx, vz, t = 0</span>
    <span class="p">)</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span>
        <span class="n">phaseRegs</span><span class="o">.</span><span class="n">Back</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># Final y, vx, vz = 0</span>
    <span class="p">)</span>

    <span class="c1"># 4: Solve</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">EContol</span> <span class="o">=</span> <span class="n">tol</span>  <span class="c1"># Equality constraint tolerance</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

    <span class="c1"># 5: Get solution and return</span>
    <span class="n">trajSol</span> <span class="o">=</span> <span class="n">odePhase</span><span class="o">.</span><span class="n">returnTraj</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">trajSol</span>
</pre></div>
</div>
<p>First, the guess is integrated to the specified final time in a given number of steps.
The <code class="code docutils literal notranslate"><span class="pre">steps</span></code> argument given here can override the previous <code class="code docutils literal notranslate"><span class="pre">dt</span></code> only if <span class="math notranslate nohighlight">\(\frac{t_f - t_0}{steps} &lt; \delta t\)</span>.
Thus, <code class="code docutils literal notranslate"><span class="pre">trajGuess</span></code> is a list of states that compose a trajectory.</p>
<p>The optimal control phase is associated with the CR3BP ODE, and is initialized to use an LGL3 collocation scheme via the enumerator <code class="code docutils literal notranslate"><span class="pre">tModes</span></code>.
When we pass in <code class="code docutils literal notranslate"><span class="pre">trajGuess</span></code>, we need to tell the phase how many LGL3 arcs to split it into.
This parameter must be high enough to generate an accurate approximation of the real dynamics, but it can negatively impact runtime if it is too large.
In general, basic trial and error is sufficient to tune this parameter.
Lastly, the phase is told to use 8 CPU threads.
You could scale this term up or down to fit your system.</p>
<p>Now we set the constraints that enforce periodicity.
Terms passed in <code class="code docutils literal notranslate"><span class="pre">fixInit</span></code> are handled first, by adding a boundary value at the front of the trajectory.
Then come the required constraints.
At the beginning of any periodic orbit, the y position and the velocity in the x and z directions must be zero to have an orthogonal crossing of the x-z plane.
We define the initial time to be zero as well.
At the end of the trajectory, the same conditions must hold, except that the final time cannot be zero for a non-trivial solution.</p>
<p>Before solving the trajectory, we must establish what constitutes a valid solution by setting a convergence tolerance.
In this scenario, the optimization problem only consists of equality constraints, so we set the value of <code class="code docutils literal notranslate"><span class="pre">EContol</span></code>.
Then a call to <code class="code docutils literal notranslate"><span class="pre">odePhase.solve()</span></code> runs everything we set up.</p>
<p>All that remains is to extract the result, which is done via <code class="code docutils literal notranslate"><span class="pre">returnTraj()</span></code>.</p>
</section>
<section id="performing-continuation">
<h2>Performing Continuation<a class="headerlink" href="#performing-continuation" title="Permalink to this heading">#</a></h2>
<p>In order to generate an orbit family, it is not sufficient to solve only <em>one</em> orbit, so let’s create another function that performs continuation by calling <code class="code docutils literal notranslate"><span class="pre">solvePeriodic</span></code> over a range of inputs.
Rudimentary continuation increments some parameter of the orbit, and then re-solves for a new orbit with the different parameter.
Also, most orbit families don’t go on forever, so we need a way to stop the progression.
With these factors in mind, we’ll start by defining the function signature.
Since <code class="code docutils literal notranslate"><span class="pre">continue</span></code> is a reserved keyword in python, we’ll abbreviate our function name to <code class="code docutils literal notranslate"><span class="pre">contin</span></code>.
Thus, our function is <code class="code docutils literal notranslate"><span class="pre">contin(ig,</span> <span class="pre">tf,</span> <span class="pre">cIdx,</span> <span class="pre">dx,</span> <span class="pre">lim,</span> <span class="pre">fixInit)</span></code>.
The first two arguments, <code class="code docutils literal notranslate"><span class="pre">ig</span></code> and <code class="code docutils literal notranslate"><span class="pre">tf</span></code> are our initial state and time guesses, just like above.
The next three arguments define the stepping and termination of the continuation scheme.
<code class="code docutils literal notranslate"><span class="pre">cIdx</span></code> is the index of the variable we are changing at each step.
To increment <span class="math notranslate nohighlight">\(x\)</span>, you would pass <code class="code docutils literal notranslate"><span class="pre">cIdx</span> <span class="pre">=</span> <span class="pre">0</span></code>.
<code class="code docutils literal notranslate"><span class="pre">dx</span></code> is how much to increment the <code class="code docutils literal notranslate"><span class="pre">cIdx</span></code> ‘th term on each iteration, and <code class="code docutils literal notranslate"><span class="pre">lim</span></code> is the value at which to terminate the continuation.
Lastly, the <code class="code docutils literal notranslate"><span class="pre">fixInit</span></code> argument comes at the end since it has a default value, and it can be used if there are elements that you definitely don’t want to change during the continuation.</p>
<p>With the arguments established, the code is presented with discussion below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># Perform basic continuation of ig along x[cIdx] with step dx up to lim</span>
<span class="k">def</span> <span class="nf">contin</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">cIdx</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">lim</span><span class="p">,</span> <span class="n">fixInit</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="n">trajList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Calculate the first orbit</span>
    <span class="n">trajList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solvePeriodic</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">odeItg</span><span class="p">,</span> <span class="n">fixInit</span><span class="p">))</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">trajList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">cIdx</span><span class="p">]</span> <span class="o">-</span> <span class="n">lim</span><span class="p">)</span>
    <span class="n">signLast</span> <span class="o">=</span> <span class="n">sign</span>
    <span class="k">while</span> <span class="n">sign</span> <span class="o">==</span> <span class="n">signLast</span><span class="p">:</span>
        <span class="c1"># Our guess for this step is the result of the last step</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">trajList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">trajList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="c1"># Increment the cIdx&#39;th term</span>
        <span class="n">g</span><span class="p">[</span><span class="n">cIdx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dx</span>

        <span class="c1"># Pass to solvePeriodic</span>
        <span class="n">sol</span> <span class="o">=</span> <span class="n">solvePeriodic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">odeItg</span><span class="p">,</span> <span class="n">fixInit</span><span class="p">)</span>

        <span class="c1"># Save result</span>
        <span class="n">trajList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">sol</span><span class="p">))</span>

        <span class="c1"># Check limit condition</span>
        <span class="n">signLast</span> <span class="o">=</span> <span class="n">sign</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">trajList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">cIdx</span><span class="p">]</span> <span class="o">-</span> <span class="n">lim</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">trajList</span>
</pre></div>
</div>
<p>As you can see, continuation can be as simple as wrapping a <code class="code docutils literal notranslate"><span class="pre">solvePeriodic</span></code> call in a while loop that terminates at the given <code class="code docutils literal notranslate"><span class="pre">lim</span></code>.
A guess for the current step is obtained from the previous step by pulling it off the end of the <code class="code docutils literal notranslate"><span class="pre">trajList</span></code> with python’s negative indices.
Then, the specified term is incremented and the <code class="code docutils literal notranslate"><span class="pre">solvePeriodic</span></code> function handles the rest.
Of course, this approach doesn’t have any error handling if an orbit doesn’t converge, but we’ve shown that a first-pass approximation can be implemented with very basic knowledge of python capabilities.</p>
</section>
<section id="running-and-plotting">
<h2>Running and Plotting<a class="headerlink" href="#running-and-plotting" title="Permalink to this heading">#</a></h2>
<p>Since we’ve put in the work up front to produce functions that capture the generic concepts of periodicity and continuation, calculating some specific orbit family can be done with minimal code.
First, here’s a quick plotting function to graph the list of trajectories we expect to recieve from <code class="code docutils literal notranslate"><span class="pre">contin</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plotTrajList</span><span class="p">(</span><span class="n">tList</span><span class="p">,</span> <span class="n">proj</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">proj</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tList</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;Plots/OrbitContinuation/Lyapunov.svg&quot;</span><span class="p">,</span>
                <span class="n">dpi</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">proj</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fig2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tList</span><span class="p">[::</span><span class="mi">5</span><span class="p">]:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot3D</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;Plots/OrbitContinuation/Halo.svg&quot;</span><span class="p">,</span>
                <span class="n">dpi</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>We’ll skip discussing this function in detail since matplotlib has it’s own documentation.</p>
<p>Now, on to what we promised from the start, L1 Lyapunovs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># Continuation - L1 Lyapunov</span>
<span class="n">ig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8234</span>  <span class="c1"># Initial x</span>
<span class="n">ig</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1263</span>  <span class="c1"># Initial vy</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mf">1.3</span>
<span class="n">tj</span> <span class="o">=</span> <span class="n">solvePeriodic</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>
<span class="n">tl</span> <span class="o">=</span> <span class="n">contin</span><span class="p">(</span><span class="n">tj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span> <span class="n">cIdx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=-</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lim</span><span class="o">=</span><span class="mf">0.77</span><span class="p">)</span>

<span class="n">tlp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tl</span><span class="p">:</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
    <span class="n">tlp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt</span> <span class="o">+</span> <span class="n">t2</span><span class="p">)</span>

<span class="n">plotTrajList</span><span class="p">(</span><span class="n">tlp</span><span class="p">)</span>
</pre></div>
</div>
<p>We pull an initial guess from any reputable source (e.g. <a class="reference external" href="https://engineering.purdue.edu/people/kathleen.howell.1/Publications/Masters/2006_Grebow.pdf">Grebow</a>), and hot-start the continuation with a preliminary solve.
In this case, we are reducing the inital <span class="math notranslate nohighlight">\(x\)</span> with each step, as indicated by <code class="code docutils literal notranslate"><span class="pre">cIdx=0</span></code> and <code class="code docutils literal notranslate"><span class="pre">dx=-0.001</span></code>.
All three initial positions are implicitly fixed by the default value of <code class="code docutils literal notranslate"><span class="pre">fixInit</span></code>; this choice will keep solutions in-plane and will ensure we don’t solve for the same trajectory twice.
Do note that the continuation limit is set such that we do not obtain the <em>full</em> family of Lyapunovs.
A smarter continuation scheme would be necessary to converge the extreme orbits.
Also, we do a bit of trickery with the plotting.
Since it’s more stable to solve for half-orbits, we duplicate the trajectory over the x-z plane so that we see the full orbit.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/Lyapunov.svg"><img alt="../_images/Lyapunov.svg" src="../_images/Lyapunov.svg" width="100%" /></a>
</figure>
<p>The code for L1 Northern Halos is almost identical, save for the initial conditions.
One notable change is the explicit definition of <code class="code docutils literal notranslate"><span class="pre">fixInit</span></code>.
In this case, we allow <span class="math notranslate nohighlight">\(x\)</span> to be adjusted by the solver as we increment <span class="math notranslate nohighlight">\(z\)</span> so that we follow the correct shape of the family.
Again, we truncate early.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># Continuation - Northern L1 Halo</span>
<span class="n">ig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8234</span>
<span class="n">ig</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1263</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mf">1.3715</span>
<span class="n">tj</span> <span class="o">=</span> <span class="n">solvePeriodic</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">fixInit</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">tl</span> <span class="o">=</span> <span class="n">contin</span><span class="p">(</span><span class="n">tj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span> <span class="n">cIdx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lim</span><span class="o">=</span><span class="mf">0.214</span><span class="p">,</span> <span class="n">fixInit</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">tlp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tl</span><span class="p">:</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
    <span class="n">tlp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt</span> <span class="o">+</span> <span class="n">t2</span><span class="p">)</span>

<span class="n">plotTrajList</span><span class="p">(</span><span class="n">tlp</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/Halo.svg"><img alt="../_images/Halo.svg" src="../_images/Halo.svg" width="100%" /></a>
</figure>
<section id="full-code">
<h3>Full Code<a class="headerlink" href="#full-code" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">asset_asrl</span> <span class="k">as</span> <span class="nn">ast</span>
<span class="kn">from</span> <span class="nn">asset_asrl.Astro.AstroModels</span> <span class="kn">import</span> <span class="n">CR3BP</span>
<span class="kn">import</span> <span class="nn">asset_asrl.Astro.Constants</span> <span class="k">as</span> <span class="nn">c</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="c1">################################################################################</span>
<span class="c1"># Setup</span>
<span class="n">oc</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">OptimalControl</span>
<span class="n">vf</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">VectorFunctions</span>

<span class="n">phaseRegs</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">PhaseRegionFlags</span>
<span class="n">tModes</span> <span class="o">=</span> <span class="n">oc</span><span class="o">.</span><span class="n">TranscriptionModes</span>

<span class="c1">################################################################################</span>
<span class="c1"># Constants</span>
<span class="n">muE</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">MuEarth</span>  <span class="c1"># Earth gravitational parameter</span>
<span class="n">muM</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">MuMoon</span> <span class="c1"># Moon gravitational parameter</span>
<span class="n">lstar</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">LD</span> <span class="c1">#Earth-Moon characteristic distance (m)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">3.1415</span> <span class="o">/</span> <span class="mi">10000</span>

<span class="c1">################################################################################</span>
<span class="c1"># System Dynamics</span>

<span class="n">ode</span> <span class="o">=</span> <span class="n">CR3BP</span><span class="p">(</span><span class="n">muE</span><span class="p">,</span> <span class="n">muM</span><span class="p">,</span> <span class="n">lstar</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">mu</span>

<span class="c1"># Create integrator (= propagator)</span>
<span class="n">odeItg</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">integrator</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>


<span class="c1">################################################################################</span>
<span class="c1"># Solve for periodic orbit using initial guess ig</span>
<span class="k">def</span> <span class="nf">solvePeriodic</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">odeItg</span><span class="p">,</span> <span class="n">fixInit</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">):</span>
    <span class="c1"># 1: Integrate initial guess</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">trajGuess</span> <span class="o">=</span> <span class="n">odeItg</span><span class="o">.</span><span class="n">integrate_dense</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>

    <span class="c1"># 2: Create optimal control phase and assign guess</span>
    <span class="n">odePhase</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">phase</span><span class="p">(</span><span class="s2">&quot;LGL3&quot;</span><span class="p">)</span>  <span class="c1"># LGL-3 collocation</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">Threads</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Equal to number of physical cores</span>

    <span class="n">nSeg</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># number of segments</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">setTraj</span><span class="p">(</span><span class="n">trajGuess</span><span class="p">,</span> <span class="n">nSeg</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">fixInit</span><span class="p">:</span>
        <span class="n">odePhase</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span><span class="s2">&quot;Front&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="p">[</span><span class="n">ig</span><span class="p">[</span><span class="n">idx</span><span class="p">]])</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span>
        <span class="s2">&quot;Front&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># Initial vx, t = 0</span>
    <span class="p">)</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">addBoundaryValue</span><span class="p">(</span>
        <span class="s2">&quot;Back&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># Final y, vx, vz = 0</span>
    <span class="p">)</span>

    <span class="c1"># 4: Solve</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">set_EContol</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>  <span class="c1"># Equality constraint tolerance</span>
    <span class="n">odePhase</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

    <span class="c1"># 5: Get solution and return</span>
    <span class="n">trajSol</span> <span class="o">=</span> <span class="n">odePhase</span><span class="o">.</span><span class="n">returnTraj</span><span class="p">()</span>


    <span class="k">return</span> <span class="n">trajSol</span>

<span class="c1">################################################################################</span>
<span class="c1"># Perform basic continuation of ig along x[cIdx] with step dx up to lim</span>
<span class="k">def</span> <span class="nf">contin</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">cIdx</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">lim</span><span class="p">,</span> <span class="n">fixInit</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="n">trajList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Calculate the first orbit</span>
    <span class="n">trajList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solvePeriodic</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">odeItg</span><span class="p">,</span> <span class="n">fixInit</span><span class="p">))</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">trajList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">cIdx</span><span class="p">]</span> <span class="o">-</span> <span class="n">lim</span><span class="p">)</span>
    <span class="n">signLast</span> <span class="o">=</span> <span class="n">sign</span>
    <span class="k">while</span> <span class="n">sign</span> <span class="o">==</span> <span class="n">signLast</span><span class="p">:</span>
        <span class="c1"># Our guess for this step is the result of the last step</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">trajList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">trajList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="c1"># Increment the cIdx&#39;th term</span>
        <span class="n">g</span><span class="p">[</span><span class="n">cIdx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dx</span>

        <span class="c1"># Pass to solvePeriodic</span>
        <span class="n">sol</span> <span class="o">=</span> <span class="n">solvePeriodic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">odeItg</span><span class="p">,</span> <span class="n">fixInit</span><span class="p">)</span>

        <span class="c1"># Save result</span>
        <span class="n">trajList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">sol</span><span class="p">))</span>

        <span class="c1"># Check limit condition</span>
        <span class="n">signLast</span> <span class="o">=</span> <span class="n">sign</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">trajList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">cIdx</span><span class="p">]</span> <span class="o">-</span> <span class="n">lim</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">trajList</span>



<span class="c1">################################################################################</span>
<span class="c1"># Use plotly to plot a list of trajectories</span>
<span class="k">def</span> <span class="nf">plotTrajList</span><span class="p">(</span><span class="n">tList</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">proj</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">proj</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tList</span><span class="p">:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;Plots/OrbitContinuation/Lyapunov.svg&quot;</span><span class="p">,</span>
                <span class="n">dpi</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">proj</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fig2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tList</span><span class="p">[::</span><span class="mi">5</span><span class="p">]:</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">plot3D</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;Plots/OrbitContinuation/Halo.svg&quot;</span><span class="p">,</span>
                <span class="n">dpi</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">################################################################################</span>
<span class="c1"># Continuation - L1 Lyapunov</span>
<span class="n">ig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8234</span>  <span class="c1"># Initial x</span>
<span class="n">ig</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1263</span>  <span class="c1"># Initial vy</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mf">1.3</span>
<span class="n">tj</span> <span class="o">=</span> <span class="n">solvePeriodic</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">odeItg</span><span class="p">)</span>
<span class="n">tl</span> <span class="o">=</span> <span class="n">contin</span><span class="p">(</span><span class="n">tj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span> <span class="n">cIdx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=-</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lim</span><span class="o">=</span><span class="mf">0.77</span><span class="p">)</span>

<span class="n">tlp</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tl</span><span class="p">:</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
    <span class="n">tlp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt</span> <span class="o">+</span> <span class="n">t2</span><span class="p">)</span>

<span class="n">plotTrajList</span><span class="p">(</span><span class="n">tlp</span><span class="p">)</span>

<span class="c1">################################################################################</span>
<span class="c1"># Continuation - Northern L1 Halo</span>
<span class="n">ig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8234</span>
<span class="n">ig</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1263</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mf">1.3715</span>
<span class="n">tj</span> <span class="o">=</span> <span class="n">solvePeriodic</span><span class="p">(</span><span class="n">ig</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">ode</span><span class="p">,</span> <span class="n">odeItg</span><span class="p">,</span> <span class="n">fixInit</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">tl</span> <span class="o">=</span> <span class="n">contin</span><span class="p">(</span><span class="n">tj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span> <span class="n">cIdx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lim</span><span class="o">=</span><span class="mf">0.214</span><span class="p">,</span> <span class="n">fixInit</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">tlp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tl</span><span class="p">:</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
    <span class="n">tlp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt</span> <span class="o">+</span> <span class="n">t2</span><span class="p">)</span>

<span class="n">plotTrajList</span><span class="p">(</span><span class="n">tlp</span><span class="p">,</span> <span class="n">proj</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="zermelo.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Zermelo’s Problem</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="HyperSensitive.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Hyper-Sensitive Optimal Control Problem</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2023, UA ASRL
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Orbit Family Continuation</a><ul>
<li><a class="reference internal" href="#problem-setup">Problem Setup</a></li>
<li><a class="reference internal" href="#constructing-a-generic-periodic-solver">Constructing a Generic Periodic Solver</a></li>
<li><a class="reference internal" href="#performing-continuation">Performing Continuation</a></li>
<li><a class="reference internal" href="#running-and-plotting">Running and Plotting</a><ul>
<li><a class="reference internal" href="#full-code">Full Code</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>